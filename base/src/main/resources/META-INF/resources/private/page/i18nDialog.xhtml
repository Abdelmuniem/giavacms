<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets">

	<p:dialog id="dialog_i18nDialog" widgetVar="i18nDialog"
		position="100,100" header="Associazione lingue" modal="true"
		width="85%">
		<p:ajax event="close" update=":central"
			listener="#{pageController.reload}" />

		<h:form id="dialog_central">
			<center>

				<p:spacer width="600px" height="1px" />
				<br />

				<h:panelGroup id="pageInfo">

					<h:panelGrid columns="2">

						<h:outputLabel for="dialog_selectedTitle"
							style="font-weight: bolder;" value="Pagina selezionata: " />
						<h:outputText id="dialog_selectedTitle"
							value="#{i18nController.element.id}" />


						<h:outputLabel for="dialog_preview" style="font-weight: bolder;"
							value="Anteprima: " />
						<h:outputLink target="_blank" id="dialog_preview"
							style="font-size: 18px; margin-left: 2px;"
							styleClass="icon-eye-open" title="anteprima"
							value="#{request.contextPath}/p/#{i18nController.element.id}">
						</h:outputLink>

						<p:spacer width="100%" height="10px" />
						<p:spacer width="100%" height="10px" />

						<h:outputLabel for="dialog_selectedLanguage"
							style="font-weight: bolder;" value="Lingue associate: " />
						<h:panelGroup id="dialog_selectedLanguage">
							<h:panelGrid columns="2">
								<h:outputText value="nessuna"
									rendered="#{i18nController.element.lang eq 0}" />
								<h:outputText value="#{language1.id} "
									rendered="#{i18nController.element.id eq i18nController.element.lang1id}" />
								<h:outputText value="#{language2.id} "
									rendered="#{i18nController.element.id eq i18nController.element.lang2id}" />
								<h:outputText value="#{language3.id} "
									rendered="#{i18nController.element.id eq i18nController.element.lang3id}" />
								<h:outputText value="#{language4.id} "
									rendered="#{i18nController.element.id eq i18nController.element.lang4id}" />
								<h:outputText value="#{language5.id} "
									rendered="#{i18nController.element.id eq i18nController.element.lang5id}" />
							</h:panelGrid>
						</h:panelGroup>

						<p:spacer width="100%" height="10px" />
						<p:spacer width="100%" height="10px" />

						<h:outputLabel value="Pagine associate per lingue alternative:"
							style="font-weight: bolder;" />
						<h:panelGrid columns="2">
							<h:outputText value="#{empty language1 ? 'n.d.' : language1.id}"
								rendered="#{not empty i18nController.element.lang1id and i18nController.element.id ne i18nController.element.lang1id}" />
							<h:outputText value="#{i18nController.element.lang1id}"
								rendered="#{not empty i18nController.element.lang1id and i18nController.element.id ne i18nController.element.lang1id}" />
							<h:outputText value="#{empty language2 ? 'n.d.' : language2.id}"
								rendered="#{not empty i18nController.element.lang2id and i18nController.element.id ne i18nController.element.lang2id}" />
							<h:outputText value="#{i18nController.element.lang2id}"
								rendered="#{not empty i18nController.element.lang2id and i18nController.element.id ne i18nController.element.lang2id}" />
							<h:outputText value="#{empty language3 ? 'n.d.' : language3.id}"
								rendered="#{not empty i18nController.element.lang3id and i18nController.element.id ne i18nController.element.lang3id}" />
							<h:outputText value="#{i18nController.element.lang3id}"
								rendered="#{not empty i18nController.element.lang3id and i18nController.element.id ne i18nController.element.lang3id}" />
							<h:outputText value="#{empty language4 ? 'n.d.' : language4.id}"
								rendered="#{not empty i18nController.element.lang4id and i18nController.element.id ne i18nController.element.lang4id}" />
							<h:outputText value="#{i18nController.element.lang4id}"
								rendered="#{not empty i18nController.element.lang4id and i18nController.element.id ne i18nController.element.lang4id}" />
							<h:outputText value="#{empty language5 ? 'n.d.' : language5.id}"
								rendered="#{not empty i18nController.element.lang5id and i18nController.element.id ne i18nController.element.lang5id}" />
							<h:outputText value="#{i18nController.element.lang5id}"
								rendered="#{not empty i18nController.element.lang5id and i18nController.element.id ne i18nController.element.lang5id}" />
						</h:panelGrid>

						<p:spacer width="100%" height="10px" />
						<p:spacer width="100%" height="10px" />

						<h:outputLabel for="languageToEdit" style="font-weight: bolder;"
							value="Seleziona lingua da modificare: " />
						<p:selectOneMenu id="languageToEdit"
							value="#{i18nController.languageToEdit}">
							<f:selectItems value="#{languageItems}" />
							<p:ajax event="change" update="pagesToChoose" />
						</p:selectOneMenu>
					</h:panelGrid>
				</h:panelGroup>

				<p:spacer width="100%" height="10px" />
				<br />

				<h:panelGroup id="pagesToChoose">
					<h:panelGroup rendered="#{i18nController.languageToEdit gt 0}">

						<p:panel header="Ricerca Pagine">

							<h:panelGrid columns="7" rendered="true">

								<h:outputLabel for="dialog_nome" value="Nome:" />
								<h:outputLabel for="dialog_staticita" value="Contenuto: " />
								<h:outputLabel for="dialog_lingua" value="Lingua: " />
								<h:outputLabel for="dialog_extended" value="Estensioni:" />
								<h:outputLabel for="dialog_extension" value="Tipologia:" />
								<h:outputLabel for="dialog_cloni" value="Mostra cloni: " />
								<h:outputLabel for="dialog_cerca" value="" />

								<h:inputText id="dialog_nome"
									value="#{i18nController.search.obj.title}" />
								<h:selectOneMenu id="dialog_staticita"
									value="#{i18nController.search.obj.template.template.searchStatico}">
									<f:selectItems value="#{staticoDinamicoItems}" />
								</h:selectOneMenu>
								<h:selectOneMenu id="dialog_lingua"
									value="#{i18nController.search.obj.lang}">
									<f:selectItems value="#{languageItems}" />
								</h:selectOneMenu>
								<h:selectBooleanCheckbox id="dialog_extended"
									value="#{i18nController.search.obj.extended}">
									<p:ajax event="change" update="dialog_extension dialog_cloni" />
								</h:selectBooleanCheckbox>
								<h:selectOneMenu id="dialog_extension"
									value="#{i18nController.search.obj.extension}">
									<f:selectItems value="#{extensionTypeItems}" />
								</h:selectOneMenu>
								<h:selectBooleanCheckbox id="dialog_cloni"
									value="#{i18nController.search.obj.clone}" />

								<p:commandButton action="#{i18nController.reloadAjax}"
									id="dialog_cerca" value="Cerca" ajax="true" immediate="false"
									update="dialog_pagesList" />
							</h:panelGrid>
							<br />

							<p:dataTable id="dialog_pagesList" rowIndexVar="rowIndex" var="p"
								value="#{i18nController.model}" rows="5" paginator="true"
								paginatorPosition="bottom" lazy="true" style="width: 98%;">
								<p:column width="50">
									<center>
										<h:outputText value="#{rowIndex+1} " />
									</center>
								</p:column>
								<p:column style="width: 10px">
									<p:rowToggler />
								</p:column>
								<p:column width="150" headerText="titolo">
									<h:outputText value="#{p.title}" />
								</p:column>
								<p:column width="250" headerText="descrizione">
									<h:outputText value="#{p.description}" />
								</p:column>
								<p:column width="60" headerText="contenuto">
									<h:outputText value="statico"
										rendered="#{p.template.template.statico}" />
									<h:outputText value="dinamico"
										rendered="#{not p.template.template.statico}" />
								</p:column>
								<p:column width="50" headerText="lingue associate">
									<center>
										<h:outputText value="#{language1.id} "
											rendered="#{p.id eq p.lang1id}" />
										<h:outputText value="#{language2.id} "
											rendered="#{p.id eq p.lang2id}" />
										<h:outputText value="#{language3.id} "
											rendered="#{p.id eq p.lang3id}" />
										<h:outputText value="#{language4.id} "
											rendered="#{p.id eq p.lang4id}" />
										<h:outputText value="#{language5.id} "
											rendered="#{p.id eq p.lang5id}" />
									</center>
								</p:column>

								<p:column headerText="anteprima">
									<center>
										<h:outputLink target="_blank"
											style="font-size: 18px; margin-left: 2px;"
											styleClass="icon-eye-open" title="anteprima"
											value="#{request.contextPath}/p/#{p.id}">
										</h:outputLink>
									</center>
								</p:column>

								<p:column headerText="associa / rimuovi">
									<center>

										<ui:fragment
											rendered="#{empty i18nController.element.getI18N(i18nController.languageToEdit) or i18nController.element.getI18N(i18nController.languageToEdit) ne p.id}">

											<p:commandLink
												action="#{i18nController.associate(p.id,false)}"
												update=":dialog_central:pageInfo :dialog_central:pagesToChoose"
												styleClass="icon-thumbs-up-alt" title="associa"
												style="margin-left: 10px; font-size: 24px;">
											</p:commandLink>

											<p:spacer width="10px" height="1px" />

											<p:commandLink
												action="#{i18nController.associate(p.id,true)}"
												update=":dialog_central:pageInfo :dialog_central:pagesToChoose"
												styleClass="icon-thumbs-up"
												style="margin-left: 10px; font-size: 24px;"
												title="associa in modo bidirezionale"
												rendered="#{i18nController.element.id ne p.id}">
											</p:commandLink>

										</ui:fragment>

										<ui:fragment
											rendered="#{i18nController.element.getI18N(i18nController.languageToEdit) eq p.id}">

											<p:commandLink
												action="#{i18nController.deassociate(p.id,false)}"
												update=":dialog_central:pageInfo :dialog_central:pagesToChoose"
												styleClass="icon-thumbs-down-alt"
												title="rimuovi associazione"
												style="margin-left: 10px; font-size: 24px;">
											</p:commandLink>

											<p:spacer width="10px" height="1px" />

											<p:commandLink
												action="#{i18nController.deassociate(p.id,true)}"
												update=":dialog_central:pageInfo :dialog_central:pagesToChoose"
												style="margin-left: 10px; font-size: 24px;"
												styleClass="icon-thumbs-down"
												title="rimuovi associazione in modo bidirezionale"
												rendered="#{i18nController.element.id ne p.id}">
											</p:commandLink>

										</ui:fragment>

									</center>
								</p:column>
								<p:rowExpansion>
									<h:outputLabel value="Pagine associate per lingue alternative:" />
									<br />
									<h:panelGrid columns="2">
										<p:spacer width="50px" height="1px" />
										<p:spacer width="500px" height="1px" />
										<h:outputText
											value="#{empty language1 ? 'n.d.' : language1.id}" />
										<h:outputText value="#{p.lang1id}" />
										<h:outputText
											value="#{empty language2 ? 'n.d.' : language2.id}" />
										<h:outputText value="#{p.lang2id}" />
										<h:outputText
											value="#{empty language3 ? 'n.d.' : language3.id}" />
										<h:outputText value="#{p.lang3id}" />
										<h:outputText
											value="#{empty language4 ? 'n.d.' : language4.id}" />
										<h:outputText value="#{p.lang4id}" />
										<h:outputText
											value="#{empty language5 ? 'n.d.' : language5.id}" />
										<h:outputText value="#{p.lang5id}" />
									</h:panelGrid>
								</p:rowExpansion>
							</p:dataTable>
						</p:panel>

					</h:panelGroup>
				</h:panelGroup>
			</center>
		</h:form>
	</p:dialog>
</ui:composition>